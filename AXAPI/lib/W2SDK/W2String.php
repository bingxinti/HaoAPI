<?php
/**
 * 字符串处理函数库文件
 * @package W2
 * @author 琐琐
 * @since 1.0
 * @version 1.0
 */
class W2String {

    /**
     * 将文本自动加上html超链接标签
     * @param string 原文本
     * @param string 链接打开的窗口
     * @return string 包含超链接的html文本
     */
    public static function wrapLink($p_t, $p_target='_self'){
        $p_t= preg_replace("/(^|[\s ])([\w]*?)((ht|f)tp(s)?:\/\/[\w]+[^ \"\n\r\t<]*)/is",
            sprintf("$1$2<a href=\"$3\" target=\"%s\">$3</a>",$p_target), $p_t); /* http[s]//** */
        $p_t= preg_replace("/(^|[\s ])([\w]*?)((www|ftp)\.[^ \,\"\t\n\r<]*)/is",
            sprintf("$1$2<a href=\"http://$3\" target=\"%s\">$3</a>",$p_target), $p_t); /* ftp://** */
        $p_t= preg_replace("/(^|[\n ])([a-z0-9&\-_\.]+?)@([\w\-]+\.([\w\-\.]+)+)/i",
            sprintf("$1<a href=\"mailto:$2@$3\" target=\"%s\">$2@$3</a>",$p_target), $p_t); /* E-mail */
        //$p_t= preg_replace("/@(\w+)/", '<a href="http://www.twitter.com/$1" target="_blank">@$1</a>', $p_t); /* @twitter 用户 */
        //$p_t= preg_replace("/\#(\w+)/", '<a href="http://search.twitter.com/search?q=$1" target="_blank">#$1</a>',$p_t); /* #twitter 搜索 */
        return $p_t;
    }

    /**
     * 判断字符串是否以子串开头
     * @param string 原文本
     * @param string 子串
     * @param bool 是否匹配大小写(默认否)
     * @return bool 是/否
     */
    public static function startsWith($p_haystack, $p_needle, $p_caseSensitiveIgnore=false) {
        $p_h = $p_caseSensitiveIgnore ? strtolower($p_haystack): $p_haystack ;
        $p_n = $p_caseSensitiveIgnore ? strtolower($p_needle): $p_needle ;
        return strpos($p_h, $p_n)===0;
    }

    /**
     * 判断字符串是否以子串结尾
     * @param string 原文本
     * @param string 子串
     * @param bool 是否匹配大小写(默认否)
     * @return bool 是/否
     */
    public static function endsWith($p_haystack, $p_needle, $p_caseSensitiveIgnore=false) {
        $p_h = $p_caseSensitiveIgnore ? strtolower($p_haystack): $p_haystack ;
        $p_n = $p_caseSensitiveIgnore ? strtolower($p_needle): $p_needle ;
        return strrpos($p_h, $p_n) === strlen($p_h)-strlen($p_n);
    }


    /**
     * 判断字符串是否是邮件格式
     * @param string 文本
     * @return bool 是/否
     */
    public static function isEmail($p_str) {
        return (preg_match('/^[_\.0-9a-z-A-Z-]+@([0-9a-z-A-Z-][0-9a-z-A-Z-]+\.)+[a-z-A-Z-]{2,4}$/',$p_str))?true:false;
    }

    /**
     * 判断字符串是否是IP格式
     * @param string 文本
     * @return bool 是/否
     */
    public static function isIP($p_str) {
        return (preg_match('/^\d+\.\d+\.\d+\.\d+$/',$p_str))?true:false;
    }

    /**
     * 判断字符串是否是URL格式
     * @param string 文本
     * @return bool 是/否
     */
    public static function isURL($p_str) {
        return (preg_match('/^(https|http|ftp|rtsp|igmp|file|rtspt|rtspu):\/\/[\w-]*(\.[^\s]*)+/',strtolower($p_str)))?true:false;
    }


    /**
     * 判断字符串是否是URL格式组成的多个字符串
     * @param string 文本
     * @return bool 是/否
     */
    public static function isURLs($p_str) {
        $p_strNew = W2String::getHttpStrings($p_str);
        return $p_strNew == $p_str;
    }


    /**
     * 判断字符串是否是QQ格式
     * @param string 文本
     * @return bool 是/否
     */
    public static function isQQ($p_str) {
        return (preg_match('/^[1-9][0-9]{4,}$/',$p_str))?true:false;
    }


    /**
     * 判断字符串是否是账号格式 (字母开头，允许5-16字节，允许字母数字下划线)
     * @param string 文本
     * @return bool 是/否
     */
    public static function isAccount($p_str) {
        return (preg_match('/^[a-zA-Z][a-zA-Z0-9_]{4,15}$/',$p_str))?true:false;
    }



    /**
     * 判断字符串是否是手机号码
     * @param string 文本
     * @return bool 是/否
     */
    public static function isTelephone($p_str) {
        return (preg_match('/^1[34578]\d{9}$/',$p_str))?true:false;
    }

    /**
     * 构建加密字符串
     * @param string 原字符串
     * @return string 加密字符串
     */
    public static function buildHashPassword($p_password){
        if (class_exists('PasswordHash')) {
            $hasher = new PasswordHash(8, TRUE);
            return $hasher->HashPassword($p_password);
        } else {
            return $p_password;
        }
    }


    /**
     * 创建一个随机数字
     * @param integer 数字长度
     * @return string 加密字符串
     */
    public static function buildRandNumbers($p_length=6)
    {
        $chars = '0123456789';
        $verifyCode = $chars[ mt_rand(1, strlen($chars) - 1) ];//首位排除0
        for ( $i = 1; $i < $p_length; $i++ )
        {
          $verifyCode .= $chars[ mt_rand(0, strlen($chars) - 1) ];
        }
        return $verifyCode;
    }

    /**
     * 比较加密字符串
     * @param string 原字符串
     * @param string 加密字符串
     * @return bool 是/否
     */
    public static function checkHashPassword($p_originalPassword, $p_hashPassword){
        if (class_exists('PasswordHash')) {
            $hasher = new PasswordHash(8, TRUE);
            return $hasher->CheckPassword($p_originalPassword,$p_hashPassword);
        } else {
            return $p_originalPassword == $p_hashPassword;
        }
    }
    /**
     * 转换字符串中的表情使可读
     * @param string 原字符串
     * @param string 目标平台 pc ios5 ios4
     * @return bool 是/否
     */
    public static function convertEmojiForDevice($p_content, $p_device='ios5'){
        $emojiDesArray = array("[:开心]","[:微笑]","[:小眼开心]","[:高兴]","[:红脸]","[:眨眼]","[:喜欢]","[:飞吻]","[:亲一个]","[:小眼亲一个]","[:再亲一个]","[:鬼脸]","[:闭眼]","[:吐舌头]","[:害羞]","[:嘻嘻]","[:沉思]","[:懂得入]","[:斜视]","[:失望]","[:呜呜]","[:悲伤]","[:泪笑]","[:大哭]","[:困倦]","[:汗哦]","[:冷汗]","[:破涕为笑]","[:汗]","[:苦气]","[:真苦气]","[:害怕]","[:恐怖]","[:不高兴]","[:撅嘴]","[:气喘吁吁]","[:困惑]","[:邪恶的笑]","[:舔嘴唇]","[:口罩]","[:酷酷太阳镜]","[:非常困倦]","[:非常吃惊]","[:吃惊]","[:小眼不开心]","[:惊讶沮丧]","[:惊愕沮丧]","[:微笑恶魔]","[:恶魔]","[:小眼惊讶]","[:唧唧]","[:平静]","[:有点不高兴]","[:有点惊讶]","[:面无表情]","[:笑晕了]","[:假笑]","[:保持沉默]","[:瓜皮帽]","[:包头巾]","[:警察]","[:建筑工人]","[:卫兵]","[:婴儿]","[:男孩]","[:女孩]","[:男人]","[:女人]","[:老爷爷]","[:老奶奶]","[:金发碧眼]","[:天使]","[:公主]","[:开心猫]","[:大笑猫]","[:痴情猫]","[:亲亲猫]","[:假笑猫]","[:尖叫猫]","[:哭泣猫]","[:泪笑猫]","[:猫不理]","[:般若]","[:面具]","[:非礼勿视]","[:非礼勿听]","[:非礼勿言]","[:头骨]","[:火星人]","[:大便]","[:火焰]","[:金星]","[:星星]","[:流星]","[:爆炸]","[:心情]","[:汗水]","[:水滴]","[:睡觉]","[:快跑]","[:耳朵]","[:眼睛]","[:鼻子]","[:舌头]","[:嘴巴]","[:手势]","[:鄙视]","[:哦了]","[:拳头]","[:握拳]","[:OK]","[:再见]","[:不行]","[:勾手]","[:上面]","[:下面]","[:右边]","[:左边]","[:洗手]","[:祈祷]","[:说一不二]","[:鼓掌]","[:强壮]","[:走人]","[:跑步]","[:跳舞]","[:情侣]","[:幸福之家]","[:基友]","[:蕾丝]","[:亲吻]","[:夫妇]","[:兔女郎]","[:没问题]","[:不可以]","[:欢迎下次再来]","[:欢迎光临]","[:轻松一下]","[:理发]","[:指甲油]","[:美丽新娘]","[:有女孩看你哦]","[:女孩伤心了]","[:鞠躬]","[:礼帽]","[:皇冠]","[:女士帽]","[:运动鞋]","[:褐色运动鞋]","[:凉鞋]","[:高跟鞋]","[:长靴]","[:女式蓝衬衫]","[:男式衬衫]","[:女式紫衬衫]","[:裙子]","[:丝带背心]","[:女式牛仔裤]","[:和服]","[:比基尼]","[:公文包]","[:手提包]","[:黄褐色钱包]","[:粉红色钱包]","[:太阳镜]","[:丝带]","[:雨伞]","[:口红]","[:黄心]","[:蓝心]","[:紫心]","[:绿心]","[:红心]","[:心碎]","[:心跳加速]","[:心动]","[:两颗心]","[:心中有想法]","[:心相应]","[:一见钟情]","[:表白信]","[:唇印]","[:戒指]","[:钻石]","[:神秘人物]","[:神秘人群]","[:对话气泡]","[:脚印]","[:思考气泡]","[:小狗]","[:狼]","[:猫]","[:老鼠头]","[:仓鼠]","[:兔子头]","[:青蛙]","[:老虎头]","[:树袋熊]","[:熊]","[:猪头]","[:猪鼻]","[:母牛头]","[:野猪]","[:猴脸]","[:猴子]","[:马头]","[:绵羊]","[:大象]","[:熊猫]","[:企鹅]","[:鸟]","[:小鸡]","[:小鸡唧唧]","[:小鸡摇摇]","[:鸡]","[:蛇]","[:龟]","[:毛毛虫]","[:蜜蜂]","[:蚂蚁]","[:瓢虫]","[:蜗牛]","[:章鱼]","[:海贝]","[:热带鱼]","[:鱼]","[:鲸鱼]","[:海豚]","[:抹香鲸]","[:母牛]","[:公羊]","[:老鼠]","[:水牛]","[:老虎]","[:兔子]","[:龙]","[:马]","[:山羊]","[:公鸡]","[:狗]","[:肥猪]","[:白老鼠]","[:公牛]","[:龙头]","[:河豚]","[:鳄鱼]","[:骆驼]","[:单峰驼]","[:花豹]","[:家猫]","[:卷毛狮子狗]","[:掌印]","[:花束]","[:樱花]","[:郁金香]","[:好运]","[:玫瑰]","[:向日葵]","[:花朵]","[:枫叶]","[:叶子]","[:落叶]","[:树枝]","[:稻穗]","[:蘑菇]","[:仙人掌]","[:棕榈树]","[:松树]","[:枝繁叶茂]","[:板栗]","[:小苗]","[:一枝花]","[:地球仪]","[:太阳公]","[:满月公]","[:新月公]","[:新月]","[:眉月]","[:上弦月]","[:盈凸月]","[:满月]","[:亏凸月]","[:下弦月]","[:残月]","[:下弦月公]","[:上弦月公]","[:月牙]","[:欧洲半球]","[:美洲半球]","[:亚洲半球]","[:火山喷发图]","[:银河系]","[:流星图]","[:星]","[:太阳]","[:多云转晴]","[:多云]","[:闪电]","[:雨伞]","[:雪花]","[:雪人]","[:龙卷风]","[:大桥图]","[:彩虹]","[:波浪]","[:竹子]","[:爱心礼物]","[:公仔]","[:书包]","[:毕业帽]","[:鲤鱼旗]","[:烟火起]","[:烟火开]","[:风铃]","[:中秋赏月]","[:南瓜]","[:幽灵]","[:圣诞老人]","[:圣诞树]","[:礼物]","[:糖果球]","[:派对]","[:祈愿竹]","[:气球]","[:比赛中]","[:水晶球]","[:摄影机]","[:相机]","[:摄像机]","[:录像带]","[:光盘]","[:一张光盘]","[:一盒光盘]","[:软盘]","[:电脑]","[:移动电话]","[:电话]","[:电话听筒]","[:传呼机]","[:传真机]","[:卫星天线]","[:电视机]","[:收音机]","[:高音量]","[:中等音量]","[:低音量]","[:禁音]","[:铃铛]","[:铃声禁音]","[:扩音喇叭]","[:啦啦队]","[:沙漏计时开始]","[:沙漏计时中]","[:闹钟]","[:手表]","[:锁已开]","[:已锁]","[:墨水笔的锁]","[:钥匙忘拔]","[:钥匙]","[:搜索一下]","[:电灯泡]","[:手电筒]","[:高亮度]","[:低亮度]","[:电插头]","[:电池]","[:搜索]","[:浴缸]","[:洗澡]","[:淋浴头]","[:厕所]","[:扳手]","[:螺母螺栓]","[:锤子]","[:门]","[:吸烟]","[:炸弹]","[:手枪]","[:切肉刀]","[:药丸]","[:注射器]","[:钱袋]","[:一叠日元]","[:一叠美元]","[:一叠英镑]","[:一叠欧元]","[:信用卡]","[:钞票飞了]","[:打电话]","[:电子邮件]","[:收件箱]","[:发件箱]","[:信封]","[:发邮件]","[:来信]","[:邮政喇叭]","[:信箱待处理]","[:信箱已处理]","[:有未读信件]","[:空信箱]","[:邮筒]","[:包裹]","[:记录]","[:文档]","[:文档卷起]","[:标签文档]","[:条形图]","[:趋势向上]","[:趋势向下]","[:羊皮纸]","[:剪贴板]","[:日历页]","[:日历]","[:名片架]","[:文件夹]","[:打开的文件夹]","[:剪刀]","[:图钉]","[:回形针]","[:墨水笔]","[:铅笔]","[:直尺]","[:三角尺]","[:红色教科书]","[:绿色教科书]","[:蓝色教科书]","[:棕色教科书]","[:硬壳笔记本]","[:橙色笔记本]","[:便签笔记本]","[:书堆]","[:书本]","[:书签]","[:记名牌]","[:显微镜]","[:天文望远镜]","[:报纸]","[:调色板]","[:电影]","[:麦克风]","[:耳机]","[:乐谱]","[:音符]","[:乐谱符号]","[:音乐键盘]","[:小提琴]","[:小号]","[:萨克斯]","[:吉他]","[:怪兽]","[:游戏手柄]","[:王牌]","[:扑克牌]","[:红中]","[:骰子]","[:命中]","[:美式橄榄球]","[:篮球]","[:足球]","[:棒球]","[:网球]","[:台球]","[:橄榄球]","[:保龄球]","[:高尔夫]","[:山地自行车]","[:脚踏车]","[:终点]","[:赛马]","[:奖杯]","[:滑雪]","[:单板滑雪]","[:游泳]","[:冲浪]","[:钓鱼]","[:咖啡]","[:茶杯]","[:清酒]","[:奶瓶]","[:啤酒]","[:碰杯]","[:鸡尾酒]","[:热带饮料]","[:红酒]","[:刀叉]","[:披萨]","[:汉堡包]","[:薯条]","[:鸡腿]","[:带柄肉]","[:意大利面条]","[:咖喱饭]","[:虾条]","[:盒饭]","[:寿司]","[:扎鱼饼]","[:饭团]","[:米饼]","[:米饭]","[:汤面]","[:热气腾腾]","[:关东煮]","[:糯米团]","[:烹饪]","[:面包]","[:面包圈]","[:奶油蛋糕]","[:冰淇淋]","[:冰激凌]","[:刨冰]","[:生日蛋糕]","[:蛋糕]","[:曲奇]","[:巧克力棒]","[:糖果]","[:棒棒糖]","[:蜜罐]","[:苹果]","[:青苹果]","[:柑橘]","[:槟榔]","[:樱桃]","[:葡萄]","[:西瓜]","[:草莓]","[:桃子]","[:甜瓜]","[:香蕉]","[:梨子]","[:菠萝]","[:烤地瓜]","[:茄子]","[:西红柿]","[:玉米]","[:楼房]","[:花园楼房]","[:学校]","[:办公楼]","[:邮局]","[:医院]","[:银行]","[:便利商店]","[:爱情旅馆]","[:酒店]","[:爱心教堂]","[:教堂]","[:百货商店]","[:欧洲邮局]","[:夕阳]","[:黄昏]","[:日本城堡]","[:西方城堡]","[:帐篷]","[:工厂]","[:东京塔]","[:日本]","[:富士山]","[:日落]","[:日出]","[:城市夜景]","[:自由女神]","[:夜间大桥]","[:旋转木马]","[:摩天轮]","[:喷水池]","[:过山车]","[:船]","[:帆船]","[:快艇]","[:划桨船]","[:锚]","[:火箭]","[:飞机]","[:座位]","[:直升飞机]","[:蒸汽机车]","[:地铁出发]","[:地铁进站]","[:山区铁路]","[:动车]","[:火车]","[:火车头]","[:轻轨电车]","[:地铁]","[:单轨铁路]","[:有轨电车]","[:货车]","[:无轨电车]","[:公共汽车]","[:巴士]","[:休闲车]","[:汽车]","[:小汽车]","[:出租车]","[:的士]","[:小货车]","[:大货车]","[:警灯]","[:警车]","[:警察车]","[:消防车]","[:救护车]","[:面包车]","[:自行车]","[:有索缆车]","[:高架铁路]","[:高山索车]","[:拖拉机]","[:理发店]","[:公共汽车站]","[:票据]","[:红绿灯]","[:横向红绿灯]","[:警告]","[:施工]","[:盾牌]","[:加油]","[:灯笼]","[:老虎机]","[:温泉]","[:末日雕像]","[:马戏团帐篷]","[:戏子面具]","[:圆图钉]","[:标记旗]","[:日本国旗]","[:韩国国旗]","[:德国国旗]","[:中国国旗]","[:美国国旗]","[:法国国旗]","[:西班牙国旗]","[:意大利国旗]","[:俄罗斯国旗]","[:英国国旗]","[:号码1]","[:号码2]","[:号码3]","[:号码4]","[:号码5]","[:号码6]","[:号码7]","[:号码8]","[:号码9]","[:号码0]","[:号码10]","[:数字限定]","[:井号]","[:符号限定]","[:按钮上]","[:按钮下]","[:按钮左]","[:按钮右]","[:大写字母限定]","[:小写字母限定]","[:字母限定]","[:按钮右上]","[:按钮左上]","[:按钮右下]","[:按钮左下]","[:左右箭头]","[:上下箭头]","[:旋转箭头]","[:后退]","[:播放]","[:向上移动]","[:向下移动]","[:撤销]","[:重做]","[:信息]","[:快退]","[:快进]","[:快速向上]","[:快速向下]","[:右行向下]","[:右行向上]","[:好]","[:随机播放]","[:重复播放]","[:单曲循环]","[:新]","[:顶]","[:酷]","[:免费]","[:没通过]","[:信号不错]","[:视频]","[:目的地]","[:预订]","[:空]","[:满]","[:合格]","[:禁止]","[:特价]","[:打折]","[:营业]","[:有]","[:无]","[:卫生间]","[:男士]","[:女士]","[:婴儿]","[:厕所]","[:饮水]","[:垃圾桶]","[:停车]","[:轮椅]","[:禁止吸烟]","[:月]","[:申请]","[:尺码]","[:字母M]","[:护照检查处]","[:行李领取处]","[:行李寄存处]","[:海关]","[:可以]","[:秘密]","[:祝福]","[:CL]","[:SOS]","[:ID]","[:受限]","[:十八禁]","[:禁止通讯设备]","[:勿扔杂物]","[:非饮用水]","[:禁止骑车]","[:禁止行人]","[:学童经过]","[:不得入内]","[:八轴星]","[:火花]","[:叉号]","[:勾号]","[:十字路口]","[:心型装饰]","[:对比]","[:震动模式]","[:手机关机]","[:按钮A]","[:按钮B]","[:AB同按]","[:按钮O]","[:方向键盘]","[:连线中]","[:可回收]","[:牡羊座]","[:金牛座]","[:双子座]","[:巨蟹座]","[:狮子座]","[:处女座]","[:天秤座]","[:天蝎座]","[:射手座]","[:摩羯座]","[:水瓶座]","[:双鱼座]","[:蛇夫座]","[:六角星]","[:取款机]","[:汇率变动]","[:美元]","[:货币兑换]","[:版权所有]","[:已注册]","[:注册中]","[:歌记号]","[:连接线]","[:顶部]","[:结束]","[:返回]","[:拨动型开关]","[:快速通过]","[:叉叉]","[:圈圈]","[:红色感叹号]","[:红色问号]","[:感叹号]","[:问号]","[:循环]","[:十二点钟]","[:十二点半]","[:一点钟]","[:一点半]","[:两点钟]","[:两点半]","[:三点钟]","[:三点半]","[:四点钟]","[:四点半]","[:五点钟]","[:五点半]","[:六点钟]","[:六点半]","[:七点钟]","[:七点半]","[:八点钟]","[:八点半]","[:九点钟]","[:九点半]","[:十点钟]","[:十点半]","[:十一点钟]","[:十一点半]","[:乘号]","[:加号]","[:减号]","[:除号]","[:黑桃]","[:红桃]","[:梅花]","[:方块]","[:作业优秀]","[:满分]","[:正确]","[:选中]","[:可供勾选]","[:链接]","[:卷曲]","[:三叉戟]","[:大黑方块]","[:大白方块]","[:黑方块]","[:白方块]","[:小黑方块]","[:小白方块]","[:小红三角]","[:黑方]","[:白方]","[:黑球]","[:白球]","[:红球]","[:蓝球]","[:小红倒三角]","[:白方形]","[:黑方形]","[:橙菱形]","[:蓝菱形]","[:小橙菱形]","[:小蓝菱形]","[:超级感叹]","[:惊叹]");
        $emoji4Array = array("","","[:小眼开心]","","","","","","","[:小眼亲一个]","[:再亲一个]","","","[:吐舌头]","","","","","","","","","","","","","","[:破涕为笑]","","[:苦气]","[:真苦气]","","","","","[:气喘吁吁]","","[:邪恶的笑]","[:舔嘴唇]","","[:酷酷太阳镜]","[:非常困倦]","[:非常吃惊]","","[:小眼不开心]","[:惊讶沮丧]","[:惊愕沮丧]","[:微笑恶魔]","","[:小眼惊讶]","[:唧唧]","[:平静]","[:有点不高兴]","[:有点惊讶]","[:面无表情]","[:笑晕了]","","[:保持沉默]","","","","","","","","","","","","","","","","[:开心猫]","[:大笑猫]","[:痴情猫]","[:亲亲猫]","[:假笑猫]","[:尖叫猫]","[:哭泣猫]","[:泪笑猫]","[:猫不理]","[:般若]","[:面具]","[:非礼勿视]","[:非礼勿听]","[:非礼勿言]","","","","","","","[:流星]","[:爆炸]","","","[:水滴]","","","","","","[:舌头]","","","","","","","","","","","","","","","","","","","","","","","","[:幸福之家]","[:基友]","[:蕾丝]","","","","","","","[:欢迎光临]","","","","[:美丽新娘]","[:有女孩看你哦]","[:女孩伤心了]","","","","","","[:褐色运动鞋]","","","","","","[:女式紫衬衫]","","[:丝带背心]","[:女式牛仔裤]","","","","","[:黄褐色钱包]","[:粉红色钱包]","[:太阳镜]","","","","","","","","","","","","[:两颗心]","[:心中有想法]","[:心相应]","","[:表白信]","","","","[:神秘人物]","[:神秘人群]","[:对话气泡]","","[:思考气泡]","","","","","","","","","","","","[:猪鼻]","","","","","","","","[:熊猫]","","","","[:小鸡唧唧]","[:小鸡摇摇]","","","[:龟]","","[:蜜蜂]","[:蚂蚁]","[:瓢虫]","[:蜗牛]","","","","","","","[:抹香鲸]","[:母牛]","[:公羊]","[:老鼠]","[:水牛]","[:老虎]","[:兔子]","[:龙]","","[:山羊]","[:公鸡]","[:狗]","[:肥猪]","[:白老鼠]","[:公牛]","[:龙头]","[:河豚]","[:鳄鱼]","","[:单峰驼]","[:花豹]","[:家猫]","[:卷毛狮子狗]","[:掌印]","","","","","","","","","","","[:树枝]","","[:蘑菇]","","","[:松树]","[:枝繁叶茂]","[:板栗]","[:小苗]","[:一枝花]","[:地球仪]","[:太阳公]","[:满月公]","[:新月公]","[:新月]","[:眉月]","[:上弦月]","[:盈凸月]","[:满月]","[:亏凸月]","[:下弦月]","[:残月]","[:下弦月公]","[:上弦月公]","","[:欧洲半球]","[:美洲半球]","[:亚洲半球]","[:火山喷发图]","[:银河系]","[:流星图]","[:星]","","[:多云转晴]","","","","[:雪花]","","","[:大桥图]","","","","","","","","","","","","","","","","","","[:糖果球]","","[:祈愿竹]","","","[:水晶球]","","","[:摄像机]","","","","","[:软盘]","","","","[:电话听筒]","[:传呼机]","","","","","","[:中等音量]","[:低音量]","[:禁音]","","[:铃声禁音]","","","[:沙漏计时开始]","[:沙漏计时中]","[:闹钟]","[:手表]","","","[:墨水笔的锁]","[:钥匙忘拔]","","[:搜索一下]","","[:手电筒]","[:高亮度]","[:低亮度]","[:电插头]","[:电池]","","[:浴缸]","","[:淋浴头]","","[:扳手]","[:螺母螺栓]","","[:门]","","","","[:切肉刀]","","","","[:一叠日元]","[:一叠美元]","[:一叠英镑]","[:一叠欧元]","[:信用卡]","[:钞票飞了]","","[:电子邮件]","[:收件箱]","[:发件箱]","[:信封]","","[:来信]","[:邮政喇叭]","","[:信箱已处理]","[:有未读信件]","[:空信箱]","","[:包裹]","","[:文档]","[:文档卷起]","[:标签文档]","[:条形图]","[:趋势向上]","[:趋势向下]","[:羊皮纸]","[:剪贴板]","[:日历页]","[:日历]","[:名片架]","[:文件夹]","[:打开的文件夹]","","[:图钉]","[:回形针]","[:墨水笔]","[:铅笔]","[:直尺]","[:三角尺]","[:红色教科书]","[:绿色教科书]","[:蓝色教科书]","[:棕色教科书]","[:硬壳笔记本]","[:橙色笔记本]","[:便签笔记本]","[:书堆]","","[:书签]","[:记名牌]","[:显微镜]","[:天文望远镜]","[:报纸]","","","","","[:乐谱]","","","[:音乐键盘]","[:小提琴]","","","","","[:游戏手柄]","[:王牌]","[:扑克牌]","","[:骰子]","","","","","","","","[:橄榄球]","[:保龄球]","","[:山地自行车]","[:脚踏车]","","[:赛马]","","","[:单板滑雪]","","","[:钓鱼]","","","","[:奶瓶]","","","","[:热带饮料]","[:红酒]","","[:披萨]","","","[:鸡腿]","[:带柄肉]","","","[:虾条]","","","[:扎鱼饼]","","","","","","","","","","[:面包圈]","[:奶油蛋糕]","","[:冰激凌]","","","","[:曲奇]","[:巧克力棒]","[:糖果]","[:棒棒糖]","[:蜜罐]","","[:青苹果]","","[:槟榔]","[:樱桃]","[:葡萄]","","","[:桃子]","[:甜瓜]","[:香蕉]","[:梨子]","[:菠萝]","[:烤地瓜]","","","[:玉米]","","[:花园楼房]","","","","","","","","","","","","[:欧洲邮局]","","","","","","","","[:日本]","","","","","","[:夜间大桥]","[:旋转木马]","","","","","","","[:划桨船]","[:锚]","","","","[:直升飞机]","[:蒸汽机车]","[:地铁出发]","","[:山区铁路]","[:动车]","","","[:轻轨电车]","","[:单轨铁路]","[:有轨电车]","","[:无轨电车]","","[:巴士]","","[:汽车]","","","[:的士]","[:小货车]","","[:警灯]","","[:警察车]","","","[:面包车]","","[:有索缆车]","[:高架铁路]","[:高山索车]","[:拖拉机]","","","","[:红绿灯]","","","","","","[:灯笼]","","","[:末日雕像]","[:马戏团帐篷]","[:戏子面具]","[:圆图钉]","[:标记旗]","","","","","","","","","","","","","","","","","","","","","[:号码10]","[:数字限定]","","[:符号限定]","","","","","[:大写字母限定]","[:小写字母限定]","[:字母限定]","","","","","[:左右箭头]","[:上下箭头]","[:旋转箭头]","","","[:向上移动]","[:向下移动]","[:撤销]","[:重做]","[:信息]","","","[:快速向上]","[:快速向下]","[:右行向下]","[:右行向上]","","[:随机播放]","[:重复播放]","[:单曲循环]","","","","[:免费]","[:没通过]","","","","","","","[:合格]","[:禁止]","","","","","","","","","","","[:饮水]","[:垃圾桶]","","","","","","","[:字母M]","[:护照检查处]","[:行李领取处]","[:行李寄存处]","[:海关]","[:可以]","","","[:CL]","[:SOS]","","[:受限]","","[:禁止通讯设备]","[:勿扔杂物]","[:非饮用水]","[:禁止骑车]","[:禁止行人]","[:学童经过]","[:不得入内]","","[:火花]","[:叉号]","[:勾号]","","","","","","","","","","[:方向键盘]","","[:可回收]","","","","","","","","","","","","","","","","","[:美元]","","[:版权所有]","[:已注册]","[:注册中]","","[:连接线]","","[:结束]","[:返回]","[:拨动型开关]","[:快速通过]","","","[:红色感叹号]","[:红色问号]","","","[:循环]","","[:十二点半]","","[:一点半]","","[:两点半]","","[:三点半]","","[:四点半]","","[:五点半]","","[:六点半]","","[:七点半]","","[:八点半]","","[:九点半]","","[:十点半]","","[:十一点半]","[:乘号]","[:加号]","[:减号]","[:除号]","","","","","[:作业优秀]","[:满分]","[:正确]","[:选中]","[:可供勾选]","[:链接]","[:卷曲]","","[:大黑方块]","[:大白方块]","[:黑方块]","[:白方块]","[:小黑方块]","[:小白方块]","[:小红三角]","","","[:黑球]","[:白球]","","[:蓝球]","[:小红倒三角]","[:白方形]","[:黑方形]","[:橙菱形]","[:蓝菱形]","[:小橙菱形]","[:小蓝菱形]","[:超级感叹]","[:惊叹]");
        $emoji5Array = array("😄","😃","😀","😊","☺","😉","😍","😘","😚","😗","😙","😜","😝","😛","😳","😁","😔","😌","😒","😞","😣","😢","😂","😭","😪","😥","😰","😅","😓","😩","😫","😨","😱","😠","😡","😤","😖","😆","😋","😷","😎","😴","😵","😲","😟","😦","😧","😈","👿","😮","😬","😐","😕","😯","😶","😇","😏","😑","👲","👳","👮","👷","💂","👶","👦","👧","👨","👩","👴","👵","👱","👼","👸","😺","😸","😻","😽","😼","🙀","😿","😹","😾","👹","👺","🙈","🙉","🙊","💀","👽","💩","🔥","✨","🌟","💫","💥","💢","💦","💧","💤","💨","👂","👀","👃","👅","👄","👍","👎","👌","👊","✊","✌","👋","✋","👐","👆","👇","👉","👈","🙌","🙏","☝","👏","💪","🚶","🏃","💃","👫","👪","👬","👭","💏","💑","👯","🙆","🙅","💁","🙋","💆","💇","💅","👰","🙎","🙍","🙇","🎩","👑","👒","👟","👞","👡","👠","👢","👕","👔","👚","👗","🎽","👖","👘","👙","💼","👜","👝","👛","👓","🎀","🌂","💄","💛","💙","💜","💚","❤","💔","💗","💓","💕","💖","💞","💘","💌","💋","💍","💎","👤","👥","💬","👣","💭","🐶","🐺","🐱","🐭","🐹","🐰","🐸","🐯","🐨","🐻","🐷","🐽","🐮","🐗","🐵","🐒","🐴","🐑","🐘","🐼","🐧","🐦","🐤","🐥","🐣","🐔","🐍","🐢","🐛","🐝","🐜","🐞","🐌","🐙","🐚","🐠","🐟","🐳","🐬","🐋","🐄","🐏","🐀","🐃","🐅","🐇","🐉","🐎","🐐","🐓","🐕","🐖","🐁","🐂","🐲","🐡","🐊","🐫","🐪","🐆","🐈","🐩","🐾","💐","🌸","🌷","🍀","🌹","🌻","🌺","🍁","🍃","🍂","🌿","🌾","🍄","🌵","🌴","🌲","🌳","🌰","🌱","🌼","🌐","🌞","🌝","🌚","🌑","🌒","🌓","🌔","🌕","🌖","🌗","🌘","🌜","🌛","🌙","🌍","🌎","🌏","🌋","🌌","🌠","⭐","☀","⛅","☁","⚡","☔","❄","⛄","🌀","🌁","🌈","🌊","🎍","💝","🎎","🎒","🎓","🎏","🎆","🎇","🎐","🎑","🎃","👻","🎅","🎄","🎁","🎊","🎉","🎋","🎈","🎌","🔮","🎥","📷","📹","📼","💿","📀","💽","💾","💻","📱","☎","📞","📟","📠","📡","📺","📻","🔊","🔉","🔈","🔇","🔔","🔕","📢","📣","⏳","⌛","⏰","⌚","🔓","🔒","🔏","🔐","🔑","🔎","💡","🔦","🔆","🔅","🔌","🔋","🔍","🛁","🛀","🚿","🚽","🔧","🔩","🔨","🚪","🚬","💣","🔫","🔪","💊","💉","💰","💴","💵","💷","💶","💳","💸","📲","📧","📥","📤","✉","📩","📨","📯","📫","📪","📬","📭","📮","📦","📝","📄","📃","📑","📊","📈","📉","📜","📋","📅","📆","📇","📁","📂","✂","📌","📎","✒","✏","📏","📐","📕","📗","📘","📙","📓","📔","📒","📚","📖","🔖","📛","🔬","🔭","📰","🎨","🎬","🎤","🎧","🎼","🎵","🎶","🎹","🎻","🎺","🎷","🎸","👾","🎮","🃏","🎴","🀄","🎲","🎯","🏈","🏀","⚽","⚾","🎾","🎱","🏉","🎳","⛳","🚵","🚴","🏁","🏇","🏆","🎿","🏂","🏊","🏄","🎣","☕","🍵","🍶","🍼","🍺","🍻","🍸","🍹","🍷","🍴","🍕","🍔","🍟","🍗","🍖","🍝","🍛","🍤","🍱","🍣","🍥","🍙","🍘","🍚","🍜","🍲","🍢","🍡","🍳","🍞","🍩","🍮","🍦","🍨","🍧","🎂","🍰","🍪","🍫","🍬","🍭","🍯","🍎","🍏","🍊","🍋","🍒","🍇","🍉","🍓","🍑","🍈","🍌","🍐","🍍","🍠","🍆","🍅","🌽","🏠","🏡","🏫","🏢","🏣","🏥","🏦","🏪","🏩","🏨","💒","⛪","🏬","🏤","🌇","🌆","🏯","🏰","⛺","🏭","🗼","🗾","🗻","🌄","🌅","🌃","🗽","🌉","🎠","🎡","⛲","🎢","🚢","⛵","🚤","🚣","⚓","🚀","✈","💺","🚁","🚂","🚊","🚉","🚞","🚆","🚄","🚅","🚈","🚇","🚝","🚋","🚃","🚎","🚌","🚍","🚙","🚘","🚗","🚕","🚖","🚛","🚚","🚨","🚓","🚔","🚒","🚑","🚐","🚲","🚡","🚟","🚠","🚜","💈","🚏","🎫","🚦","🚥","⚠","🚧","🔰","⛽","🏮","🎰","♨","🗿","🎪","🎭","📍","🚩","🇯🇵","🇰🇷","🇩🇪","🇨🇳","🇺🇸","🇫🇷","🇪🇸","🇮🇹","🇷🇺","🇬🇧","1⃣","2⃣","3⃣","4⃣","5⃣","6⃣","7⃣","8⃣","9⃣","0⃣","🔟","🔢","#⃣","🔣","⬆","⬇","⬅","➡","🔠","🔡","🔤","↗","↖","↘","↙","↔","↕","🔄","◀","▶","🔼","🔽","↩","↪","ℹ","⏪","⏩","⏫","⏬","⤵","⤴","🆗","🔀","🔁","🔂","🆕","🆙","🆒","🆓","🆖","📶","🎦","🈁","🈯","🈳","🈵","🈴","🈲","🉐","🈹","🈺","🈶","🈚","🚻","🚹","🚺","🚼","🚾","🚰","🚮","🅿","♿","🚭","🈷","🈸","🈂","Ⓜ","🛂","🛄","🛅","🛃","🉑","㊙","㊗","🆑","🆘","🆔","🚫","🔞","📵","🚯","🚱","🚳","🚷","🚸","⛔","✳","❇","❎","✅","✴","💟","🆚","📳","📴","🅰","🅱","🆎","🅾","💠","➿","♻","♈","♉","♊","♋","♌","♍","♎","♏","♐","♑","♒","♓","⛎","🔯","🏧","💹","💲","💱","©","®","™","〽","〰","🔝","🔚","🔙","🔛","🔜","❌","⭕","❗","❓","❕","❔","🔃","🕛","🕧","🕐","🕜","🕑","🕝","🕒","🕞","🕓","🕟","🕔","🕠","🕕","🕡","🕖","🕢","🕗","🕣","🕘","🕤","🕙","🕥","🕚","🕦","✖","➕","➖","➗","♠","♥","♣","♦","💮","💯","✔","☑","🔘","🔗","➰","🔱","◼","◻","◾","◽","▪","▫","🔺","🔲","🔳","⚫","⚪","🔴","🔵","🔻","⬜","⬛","🔶","🔷","🔸","🔹","‼","⁉");
        if ($p_device=="pc"){
            $p_content = str_replace($emoji4Array, $emojiDesArray, $p_content);
            $p_content = str_replace($emoji5Array, $emojiDesArray, $p_content);
        }
        else if ($p_device=="ios4"){
            $p_content = str_replace($emojiDesArray, $emoji4Array, $p_content);
            $p_content = str_replace($emoji5Array, $emoji4Array, $p_content);
        }
        else if ($p_device=="ios5"){
            $p_content = str_replace($emojiDesArray, $emoji5Array, $p_content);
            $p_content = str_replace($emoji5Array, $emoji5Array, $p_content);
        }
        return $p_content;
    }
    /**
     * 转换字符串中的表情使可读
     * @param string 原字符串
     * @param string 目标平台 pc ios5 ios4
     * @return bool 是/否
     */
    // public static function convertEmojiUtfForDevice($p_content, $p_device='ios5'){
    //     return $p_content;
    // }
    /**
     * 转换字符串中的ubb代码使可读
     * @param string 原字符串
     * @param string 目标平台 pc ios5 ios4
     * @return bool 是/否
     */
    public static function ubbDecodeLite($s, $p_device='ios5'){
        $s = preg_replace('/</','&lt;',$s);
        $s = preg_replace('/>/','&gt;',$s);
        $s = preg_replace('/"/','&quot;',$s);
        $s = preg_replace('/\'/','&#39;',$s);
        $s = preg_replace('/&lt;br.*?&gt;/','<br />',$s);
        $s = preg_replace('/&lt;p&gt;/','<p>',$s);
        $s = preg_replace('/&lt;\/p&gt;/','</p>',$s);
        $s = preg_replace('/([^\]^=]|^)(https?)(:\S+)\.(gif|png|bmp|jpg)/i','$1[img]$2$3.$4[/img]',$s);//[ur,$sl]
        $s = preg_replace('/@([^\.\s<>]*)(\s)/i','[url=/$1]@$1[/url]$2',$s);//[ur,$sl]
        $s = preg_replace('/([^\]=]|^)(https?|ftp|gopher|news|telnet|mms|rtsp)(:[\w\-\.\/?\@\%\!\&=\+\~\:\#\;\,]+)/i','$1[url=$2$3]$2$3[/url]',$s);//[ur,$sl]
        $s = preg_replace('/\[url\](https?|ftp|gopher|news|telnet|mms|rtsp)(:.+?)\[\/url\]/i','[url=$1$2]$1$2[/url]',$s);//[ur,$sl]
        $s = preg_replace('/\[url=(.*?)\](.+?)\[\/url\]/i','<a href="$1" >$2</a>',$s);

//for ios
    $s = preg_replace('/\[item=(\d+?)-(\d+?)-(.*?)\](.*?)\[\/item\]/i','<a href="http://www.appjk.com/item/$1-$2-$3"> [item$1:$4]</a>',$s);
    $s = preg_replace('/\[app.*?(\d{9}).*?\[\/app\]/i','<a href="http://www.appjk.com/app/$1"> [app]</a>',$s);
    $s = preg_replace('/\[video](.+?)\[\/video\]/i','<a href="$1"> [video]</a>',$s);
    $s = preg_replace('/\[img(\d{0,3})\](.+?)\[\/img\]/i','<img src="$2"/>',$s);

        $s = W2String::convertEmojiForDevice($s,$p_device);//emoji

        return $s;
    }
    /**
     * 转换字符串中的ubb代码使可读
     * @param string 原字符串
     * @param string 目标平台 pc ios5 ios4
     * @return bool 是/否
     */
    public static function ubbDecode($s, $p_device='ios5'){
    $s = preg_replace('/\n/i',"</p>\n<p>",$s);
    // $s = '<p>'.$s.'</p>';

    $s = W2String::ubbDecodeLite($s,$p_device);

    $s = preg_replace('/&lt;br&gt;/i','<br />',$s);

    //quote
    do{
        $s = preg_replace('/\[quote\]([\s\S]*)\[\/quote\]/','<div class="ubb-quote">$1</div>',$s);
    }
    while(preg_match('/\[quote\]([\s\S]*)\[\/quote\]/',$s)) ;





    $s = preg_replace('/\[b\]([\s\S]*?)\[\/b\]/','<b>$1</b>',$s);
    $s = preg_replace('/\[del\](.+?)\[\/del\]/i',"<del class='gray'> $1 </del>",$s);//[de,$sl]
    $s = preg_replace('/\[u\](.+?)\[\/u\]/i',"<u>$1</u>",$s);//[,$su]
    $s = preg_replace('/\[i\](.+?)\[\/i\]/i',"<i style='font-style:italic'>$1</i>",$s);//[,$si]
    $s = preg_replace('/\[color=(skyblue|royalblue|blue|darkblue|orange|orangered|crimson|red|firebrick|darkred|green|limegreen|seagreen|teal|deeppink|tomato|coral|purple|indigo|burlywood|sandybrown|sienna|chocolate|silver|gray)\](.+?)\[\/color\]/i',"<span style='color:$1'>$2</span>",$s);//[colo,$sr]
    $s = preg_replace('/\[size=(\d{1,3})%?\](.*?)\[\/size\]/i','<span style="font-size:$1%;line-height:183%"></span>',$s);
    $s = preg_replace('/\[font=(simsun|simhei|Arial|Arial Black|Book Antiqua|Century Gothic|Comic Sans MS|Courier New|Georgia|Impact|Tahoma|Times New Roman|Trebuchet MS|Script MT Bold|Stencil|Verdana|Lucida Console)\](.+?)\[\/font\]/i',"<span style='font-family:$1'>$2</span>",$s);//[fon,$st]
    $s = preg_replace('/\[align=(left|center|right)\]([\s\S]+?)\[\/align\]/i',"<div style='text-align:$1'>$2</div>",$s);//[fon,$st]


    // );//[table] */

        return $s;
    }

    /**
     * 转换字符串中的ubb代码使可读
     * @param string 原字符串
     * @param string 目标平台 pc ios5 ios4
     * @return bool 是/否
     */
    public static function unUbbCode($s, $p_device='ios5'){
        // $s = '<p>'.$s.'</p>';

        $s = W2String::ubbDecode($s,$p_device);

        $s = preg_replace('/<div class="ubb-quote">/i',"-------------\n",$s);
        $s = preg_replace('/<a.*?href="(.*?)(|\?picUrl.*?)".*?>.*?<\/a>/i',"$1",$s);
        $s = preg_replace('/<.*?src="(.*)".*?>/i',"$1",$s);
        $s = strip_tags($s);
        return $s;
        $s = preg_replace('/<.*?href="(.*)".*?>/i',"$1",$s);
        $s = preg_replace('/<.*?>/i','',$s);

    }

    /**
     * 用逗号分隔字符串,去除无效部分,重新组合成字符串
     * @param  string $p_string 逗号组成的多个网址string
     * @return string           逗号组成的多个网址string
     */
    public static function getArrayStrings($p_string,$p_delimiter=',')
    {
        return implode($p_delimiter, W2String::getStringsArray($p_string));
    }

    /**
     * 用逗号分隔字符串得到数组,去除无效部分
     * @param  string $p_string 逗号组成的多个网址string
     * @return string           逗号组成的多个网址string
     */
    public static function getStringsArray($p_string,$p_delimiter=',')
    {
        if (!is_array($p_string))
        {
            $p_string = explode($p_delimiter, $p_string);
        }
        $p_stringList = array();
        foreach ($p_string as $s) {
            if ($s!=null)
            {
                $p_stringList[] = $s;
            }
        }
        return $p_stringList;
    }

    /**
     * 从string中取出http网址,并以逗号连接
     * @param  string $p_string 逗号组成的多个网址string
     * @return string           逗号组成的多个网址string
     */
    public static function getHttpStrings($p_string,$p_delimiter=',')
    {
        $p_stringList = array();
        foreach (explode($p_delimiter, $p_string) as $s) {
            if (W2String::isURL($s))
            {
                $p_stringList[] = $s;
            }
        }
        return implode($p_delimiter, $p_stringList);
    }

    /**
     * 将网址组成的string分解成数组
     * @param  string $p_string 逗号组成的多个网址string
     * @return string[] $p_string 多个网址string组成的数组
     */
    public static function getHttpArray($p_string,$p_delimiter=',')
    {
        return W2String::getStringsArray( W2String::getHttpStrings($p_string) , $p_delimiter);
    }

    /**
     * [getRtfContent 获取富文本内容]
     * @param  string $strContent [description]
     * @return [type]             [description]
     */
    public static function getRtfContent( $strContent = '' )
    {
        $htmlContent = '<!DOCTYPE html>
                        <html>
                        <head>
                            <meta charset="UTF-8">
                            <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
                            <meta name="viewport" content="width=device-width,initial-scale=1.0">
                        </head>
                        <body>';
        $htmlContent .= $strContent;

        $htmlContent .= '<style type="text/css">
                                 * {padding: 0px; margin: 0px; }
                                img{max-width:100%;text-align:center;vertical-align:middle; }
                                body{padding:2%;}
                            </style>';

        $htmlContent .= '</body> </html>';
        return $htmlContent;
    }
}



?>
